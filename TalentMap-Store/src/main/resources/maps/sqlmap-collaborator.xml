<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL MAP 2.0//EN" 
	"http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="colleague">

    <typeAlias alias="colleague" type="com.novedia.talentmap.model.entity.Colleague"/> 

    <resultMap id="colleagueResult" class="colleague">
        <result property="id" column="COLLAB_ID"/>     
        <result property="managerId"  column="MANAGER_ID"/>         
        <result property="profileId"  column="PROFILE_ID"/>    	    
        <result property="lastName"   column="LAST_NAME"/>	   
        <result property="firstName"  column="FIRST_NAME"/>	   
        <result property="email"  column="EMAIL"/>	    
        <result property="phone"   column="PHONE"/>
        <result property="employmentDate"  column="EMPLOYMENT_DATE"/>	    
        <result property="experience"   column="EXPERIENCE"/>
        <result property="businessEngineer"   column="BUSINESS_ENGINEER"/>	   
    </resultMap>

    <select id="get" parameterClass="Integer" resultMap="colleagueResult">
        SELECT * FROM  COLLABORATOR WHERE COLLAB_ID = #id#
    </select>
    
    <select id="getAll" resultMap="colleagueResult">
    	SELECT * FROM COLLABORATOR
    </select>
    					 
	<update id="save" parameterClass="Colleague">
		UPDATE COLLABORATOR SET PROFILE_ID = #profileId#, PHONE = #phone#, EXPERIENCE = #experience# WHERE COLLAB_ID = #id#
	</update>
	
    <!-- v.guillemain -->
    <select id="getAllByLastName" parameterClass="String" resultMap="colleagueResult">
        SELECT * FROM  COLLABORATOR WHERE UPPER(LAST_NAME) LIKE UPPER('$lastName$%')
    </select>

    <!-- v.guillemain -->
    <select id="getAllByListId" resultMap="colleagueResult" parameterClass="java.util.Collection">
    	SELECT * FROM COLLABORATOR WHERE COLLAB_ID IN
		<iterate 	open="(" 
					close=")"
					conjunction=",">
   					#[]#
  		</iterate>
	</select>
	
    <!-- v.guillemain -->
    <select id="getAllCollaboratorsByListId2" resultMap="colleagueResult" parameterClass="com.novedia.talentmap.store.impl.SkillParameter">
    	SELECT * FROM COLLABORATOR WHERE
    	COLLAB_ID IN
		<iterate 	property="listCollaborators"
					open="(" 
					close=")"
					conjunction=",">
   					#listCollaborators[]#
  		</iterate>
    </select>	

	<insert id="add">
		<selectKey resultClass="Integer" keyProperty="id">
      		SELECT SEQCOLLABORATOR.NEXTVAL FROM DUAL
    	</selectKey>
 	
    	INSERT INTO COLLABORATOR (
    		COLLAB_ID,
    		MANAGER_ID,
    		PROFILE_ID,
    		LAST_NAME,
    		FIRST_NAME, 
    		EMAIL,
    		PHONE,
    		EMPLOYMENT_DATE,
    		EXPERIENCE,
    		BUSINESS_ENGINEER
    		)values (
    		#id#, #managerId#, #profileId#, #lastName#, #firstName#, #email#, #phone#, #employmentDate#, #experience#, #businessEngineer#
    		)
	</insert>
	
	<!-- v.guillemain -->
    <select id="getAllCollaboratorsByManagerId" parameterClass="Integer" resultMap="colleagueResult">
        SELECT * FROM COLLABORATOR WHERE MANAGER_ID = #id#
    </select>
    
</sqlMap>