<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL MAP 2.0//EN" 
	"http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="objective">

	<typeAlias alias="objective"
		type="com.novedia.talentmap.model.entity.Objective" />

	<resultMap id="objectiveResult" class="objective">
		<result property="id" column="OBJECTIVE_ID" />
		<result property="colleague.id" column="COLLEAGUE_ID" />
		<result property="manager.id" column="MANAGER_ID" />
		<result property="EAE.id" column="EAE_ID" />
		<result property="title" column="TITLE" />
		<result property="goal" column="GOAL" />
		<result property="targetDate" column="TARGET_DATE" />
		<result property="indicators" column="INDICATORS" />
		<result property="means" column="MEANS" />
		<result property="colleagueScore.id" column="COL_OBJ_SCORE_ID" />
		<result property="managerScore.id" column="MAN_OBJ_SCORE_ID" />
		<result property="motivesOrRestraints" column="MOTIVES_OR_RESTRAINTS" />
	</resultMap>

	<select id="getObjective" resultMap="objectiveResult"
		parameterClass="Integer">
		SELECT * FROM OBJECTIVE WHERE OBJECTIVE_ID = #id#
	</select>

	<select id="getAll" resultMap="objectiveResult">
		SELECT DISTINCT * FROM OBJECTIVE
	</select>

	<insert id="add" parameterClass="Category">
		INSERT INTO OBJECTIVE (
			OBJECTIVE_ID,
			COLLEAGUE_ID,
			MANAGER_ID,
			EAE_ID,
			TITLE,
			GOAL,
			TARGET_DATE,
			INDICATORS,
			MEANS,
			COL_OBJ_SCORE_ID,
			MAN_OBJ_SCORE_ID,
			MOTIVES_OR_RESTRAINTS
		)values (
			#id#,
			#colleague.id#
			#manager.id#,
			#EAE.id#,
			#title#,
			#goal#,
			#targetDate#,
			#indicators#,
			#means#,
			#colleagueScore.id#,
			#managerScore.id#,
			#motivesOrRestraints#
		)
		<selectKey keyProperty="id" resultClass="Integer">
			SELECT
			LAST_INSERT_ID() AS OBJECTIVE_ID
		</selectKey>
	</insert>

	<select id="checkObject" resultMap="objectiveResult"
		parameterClass="objective">
<!-- 		SELECT * FROM OBJECTIVE WHERE upper(CATEGORY_NAME) = -->
<!-- 		upper(#name#) -->
	</select>

	<update id="save" parameterClass="Objective">
		UPDATE OBJECTIVE SET
			COLLEAGUE_ID = #colleague.id# ,
			MANAGER_ID = #manager.id# ,
			EAE_ID = #EAE.id# ,
			TITLE = #title# ,
			GOAL = #goal# ,
			TARGET_DATE = #targetDate# ,
			INDICATORS = #indicators# ,
			MEANS = #means# ,
			COL_OBJ_SCORE_ID = #colleagueScore.id# ,
			MAN_OBJ_SCORE_ID = #managerScore.id# ,
			MOTIVES_OR_RESTRAINTS = #motivesOrRestraints#
		WHERE OBJECTIVE_ID = #id#
	</update>

	<delete id="delete" parameterClass="Objective">
		DELETE FROM OBJECTIVE WHERE
		OBJECTIVE_ID = #id#
	</delete>

</sqlMap>