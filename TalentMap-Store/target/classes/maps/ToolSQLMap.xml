<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL MAP 2.0//EN" 
	"http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="tool">

    <typeAlias alias="tool" type="com.novedia.talentmap.model.entity.Tool"/> 

    <resultMap id="toolResult" class="tool">
    	<result property="id" column="TOOL_ID"/> 
        <result property="concept_id" column="CONCEPT_ID"/>     
        <result property="name"  column="TOOL_NAME"/>          
    </resultMap>
	
	<select id="getToolById" resultMap="toolResult" parameterClass="Integer">
		SELECT * FROM TOOL WHERE TOOL_ID = #id#
	</select>
	
	<select id="getToolByName" resultMap="toolResult" parameterClass="String">
		SELECT * FROM TOOL WHERE TOOL_NAME = #name#
	</select>
	
    <select id="getAllTool" resultMap="toolResult">
    	SELECT * FROM TOOL
    </select>
    
    <select id="getAllToolByConceptId" resultMap="toolResult" parameterClass="Integer">
    	SELECT * FROM TOOL WHERE CONCEPT_ID = #conceptId#
    </select>	
    
    <insert id="insertTool" parameterClass="Tool">
    	
    	<selectKey resultClass="int" keyProperty="id">
      		SELECT SEQTOOL.NEXTVAL FROM DUAL
    	</selectKey>
    	
    	INSERT INTO TOOL (
    		TOOL_ID,
    		CONCEPT_ID, 
    		TOOL_NAME
    		)values (
    		#id#, #concept_id# , #name#
    		)
    		<selectKey keyProperty="id" resultClass="Integer">
    			SELECT LAST_INSERT_ID() AS id  
    		</selectKey>
    </insert>	
    
    <select id="checkTool" resultMap="toolResult" parameterClass="String">
		SELECT * FROM TOOL WHERE upper(TOOL_NAME) = upper(#name#)
	</select>		
	
	<update id="updateTool" parameterClass="Tool">
		UPDATE TOOL SET TOOL_ID = #id#, CONCEPT_ID = #concept_id#, TOOL_NAME = #name# WHERE TOOL_ID = #id#
	</update> 
	
	<delete id="deleteTool" parameterClass="Integer">
		DELETE TOOL CASCADE	WHERE TOOL_ID = #id#
	</delete>	 

</sqlMap>